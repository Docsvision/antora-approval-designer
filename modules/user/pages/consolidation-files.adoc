= Работа с консолидируемыми файлами

Консолидатор работает с согласуемыми файлами в области _Файлы для консолидации_ карточки _Задание -- на консолидацию_.

NOTE: Подробнее о работе с версиями файлов в режиме консолидации в {wc}е см. в документации по работе с {wc}, раздел "xref:dev@webclient:user:approval-users-consolidator.adoc[]".

Версии консолидируемых файлов обозначаются xref:consolidation-version-tree.adoc[специальными иконками].

.Консолидатору доступны операции:
* xref:approval-version-tree.adoc#view-version[Просмотр версии файла].
* xref:approval-version-tree.adoc#open-version[Открытие версии файла].
* xref:approval-version-tree.adoc#load-version[Загрузка версии из файла].
* xref:approval-version-tree.adoc#create-version[Создание версии файла на основе выбранной]. Команда создаёт новую версию, подчинённую начальной версии согласующего.
* xref:approval-version-tree.adoc#delete-version[Удаление версии файла].
* <<comments,Добавление комментария к версии>>.
* _Объединить версии_. Команда доступна для исходной версии этапа консолидации. Команда объединяет подчинённые выбранной версии, если они ещё не были консолидированы. В результате выполнения команды будет создана итоговая версия этапа консолидации.
* _Взять в качестве консолидируемой_. Команда назначает версию исходной версией этапа.
+
NOTE: Команда недоступна для усовершенствованного согласования.
+
* Команда _Сделать версию итоговой_ помечает любую выбранную версию итоговой.
* Команда _Сравнить с итоговой_ (ранее: _Сравнить с консолидируемой_). Команда сравнивает выбранную версию с итоговой версией.

[#version]
== Создание консолидированной версии

_Консолидатор_ работает с согласуемыми файлами так же, как участник согласования: может создавать свои версии, просматривать версии других согласующих, комментировать их, и при этом имеет ряд дополнительных возможностей.

.Чтобы сформировать итоговую версию согласуемого документа:
. Откройте полученную карточку задания на консолидацию.
+
В области _Файлы для консолидации_ будут отображаться стартовые версии этапов согласования и версии, добавленные согласующими.
+
Также у _Консолидатора_ будет отображаться _Итоговая версия_.
+
// tag::finver[]
// _Итоговая версия_ будет совпадать со стартовой версией этапа, если предшествующий текущему этап был параллельный, или с последней созданной на предыдущем этапе версией, если этап был последовательным или альтернативным.
.В полученном задании итоговой версией:
* Будет считаться исходная, если на предыдущем этапе не было правок.
* Будет считаться версия согласующего, если были правки только от одного согласующего.
* Будет считаться версия последнего согласующего, если предыдущий этап был последовательный.
* Будет считаться исходная версия предыдущего этапа, если предыдущий этап был параллельный.
// end::finver[]
+
.Пример отображения версий файлов у "Консолидатора"
image::version-tree-consolidation.png[Пример отображения версий файлов у "Консолидатора"]
+
// . Если на каком-либо этапе в согласовании принимали участие несколько согласующих, и было создано несколько разных версий файла, вы можете автоматически объединить версии в одну (функция предусмотрена только для файлов Microsoft Word). Для этого выделите требуемый этап, правой кнопкой мыши вызовите контекстное меню, затем выберите команду _Объединить версии_.
// +
// При этом будет сформирована _Объединенная версия этапа_, в которую будут скопированы все изменения документа, добавленные согласующими.
// +
. Последовательно сравните каждую из версий документа с итоговой. Выберите версию для сравнения, затем вызовите контекстное меню и выберите пункт _Сравнить с итоговой_.
+
.Сравнение версии согласующих с итоговой версией
image::compare-with-consolidated.png[Сравнение версии согласующих с итоговой версией]
+
Сравнение будет выполнено средствами Microsoft Word. Функция доступна только для расширений, поддерживаемых данным приложением. При сравнении будет создана новая версия, содержащая изменения из обоих документов.
+
. Выделите в дереве версию, на основе которой будет создаваться итоговая версия. Правой кнопкой мыши вызовите контекстное меню, затем выберите команду _Сделать версию итоговой_.
+
Версия, взятая за основу, в терминах системы называется "xref:consolidation-version-tree.adoc[Итоговая версия]". Взять в качестве итоговой можно любую версию файла.
+
При этом название версии будет выделено жирным, иконка сменится на image:buttons/consolidation-final.png[Две линии с узлами объединяются в стрелку вправо], перед версией появился слово "ИТОГОВАЯ".
+
.Формирование итоговой версии
image::consolidated-version.png[Формирование итоговой версии]
+
Итоговая версия в последующих этапах прохождения маршрута будет использоваться в качестве исходной.

[#comments]
== Работа с комментариями при консолидации

При выполнении консолидации предусмотрены два вида комментариев, которые могут быть добавлены _Консолидатором_:

xref:approval-version-tree.adoc#comment-version[Комментарий к версии]::
Комментарий добавляется при помощи контекстного меню, вызываемого в области _Файлы для согласования_.
+
Комментарий будет отображаться у _Инициатора_ согласования при открытии активного согласования и у _Консолидатора_ в области _Комментарии_ карточки задания.

xref:approval-decide.adoc[Комментарий к решению]::
Комментарий добавляется при принятии условно-положительного или отрицательного решения по консолидации.
+
Просмотр комментария будет доступен остальным участниками согласования в области _Комментарии_ заданий на согласование.
+
Кроме того, _консолидатору_ доступен просмотр комментариев к версиям, добавленных другими участниками согласования.

[#completion]
== Завершение задания на консолидацию

Чтобы завершить здание на консолидацию по логике усовершенствованного согласования, необходимо обязательно выбрать итоговую версию.

include::partial$excerpts.adoc[tags=on-finish]